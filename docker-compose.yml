version: "3.7"
services:

  ec_cont_es:
    image: csek06/appdynamics-server-all-in-one:dev
    container_name: appd_ec_cont_es
    hostname: $HOSTNAME
    ports:
      - "8090:8090"
      - "8181:8181"
      - "9080:9080"
      - "9081:9081"
      - "9191:9191"
    env_file:
      - your-platform.env
    environment:
      - SCENARIO=ECCONTES
      - COMPOSED=true
    volumes:
      - /opt/appdynamics:/config
  
  eum:
    image: csek06/appdynamics-server-all-in-one:dev
    container_name: appd_eum
    hostname: $HOSTNAME
    ports:
      - "7001:7001"
      - "7002:7002"
    depends_on:
      - ec_cont_es
    env_file:
      - your-platform.env
    environment:
      - SCENARIO=EUM
      - COMPOSED=true
      - CONTROLLER_HOST=ec_cont_es
    links:
      - ec_cont_es
    volumes:
      - /opt/appdynamics:/config
    restart: on-failure
      
  database_agent:
    image: csek06/appdynamics-server-all-in-one:dev
    container_name: appd_db_agent
    hostname: $HOSTNAME
    depends_on:
      - ec_cont_es
    env_file:
      - your-platform.env
    environment:
      - SCENARIO=DA
      - COMPOSED=true
      - CONTROLLER_HOST=ec_cont_es
    links:
      - ec_cont_es
    volumes:
      - /opt/appdynamics:/config
    restart: on-failure
    
  machine_agent:
    image: csek06/appdynamics-server-all-in-one:dev
    container_name: appd_ma_agent
    hostname: $HOSTNAME
    depends_on:
      - ec_cont_es
    ports:
      - "9090:9090"
      - "9091:9091"
    env_file:
      - your-platform.env
    environment:
      - SCENARIO=MAAA
      - COMPOSED=true
      - CONTROLLER_HOST=ec_cont_es
    links:
      - ec_cont_es
    volumes:
      - /opt/appdynamics:/config
    restart: on-failure